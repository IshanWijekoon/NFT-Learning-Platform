<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Details - EduChain</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
        }

        /* Navigation Bar */
        .navbar {
            position: sticky;
            top: 0;
            background: white;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            padding: 0 20px;
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            color: #2c5aa0;
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .logo:hover {
            color: #1e3f73;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 25px;
            align-items: center;
        }

        .nav-link {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            position: relative;
            transition: color 0.3s ease;
            padding: 8px 16px;
            border-radius: 20px;
        }

        .nav-link:hover {
            color: #2c5aa0;
            background: rgba(44, 90, 160, 0.1);
        }

        .logout-btn {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%) !important;
            color: white !important;
            padding: 10px 20px !important;
            border-radius: 25px !important;
            transition: all 0.3s ease !important;
        }

        .logout-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
            color: white !important;
        }

        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            padding: 5px;
            background: none;
            border: none;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background: #333;
            margin: 3px 0;
            transition: 0.3s;
            border-radius: 2px;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(-45deg) translate(-5px, 6px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(45deg) translate(-5px, -6px);
        }

        /* Main Content */
        main {
            padding: 40px 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Course Header */
        .course-header {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 40px;
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 40px;
            align-items: start;
        }

        .course-main-info h1 {
            font-size: 2.5rem;
            font-weight: 600;
            color: #1e3f73;
            margin-bottom: 15px;
            line-height: 1.3;
        }

        .course-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
            color: #666;
        }

        .course-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .course-description {
            font-size: 1.1rem;
            line-height: 1.7;
            color: #555;
            margin-bottom: 25px;
        }

        .course-stats {
            display: flex;
            gap: 30px;
            margin-bottom: 25px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #2c5aa0;
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #666;
        }

        .course-sidebar {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            height: fit-content;
        }

        .course-thumbnail {
            width: 100%;
            height: 180px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            color: white;
            margin-bottom: 20px;
        }

        .course-price {
            font-size: 2.5rem;
            font-weight: 700;
            color: #28a745;
            text-align: center;
            margin-bottom: 20px;
        }

        .enroll-btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 25px;
            background: linear-gradient(135deg, #2c5aa0 0%, #1e3f73 100%);
            color: white;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        .enroll-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(44, 90, 160, 0.3);
        }

        .enroll-btn:disabled {
            background: #28a745;
            cursor: not-allowed;
        }

        .watch-btn {
            width: 100%;
            padding: 15px;
            border: 2px solid #2c5aa0;
            border-radius: 25px;
            background: white;
            color: #2c5aa0;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
            display: block;
        }

        .watch-btn:hover {
            background: #2c5aa0;
            color: white;
        }

        /* Reviews Section */
        .reviews-section {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        }

        .section-title {
            font-size: 2rem;
            font-weight: 600;
            color: #1e3f73;
            margin-bottom: 30px;
        }

        /* Review Form */
        .review-form {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 40px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .star-rating {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
        }

        .star {
            font-size: 2rem;
            color: #ddd;
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .star.active,
        .star:hover {
            color: #ffc107;
        }

        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            resize: vertical;
            min-height: 120px;
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group textarea:focus {
            outline: none;
            border-color: #2c5aa0;
            box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
        }

        .submit-review-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .submit-review-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        /* Reviews List */
        .reviews-list {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }

        .review-item {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            transition: transform 0.3s ease;
        }

        .review-item:hover {
            transform: translateY(-2px);
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .reviewer-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .reviewer-avatar {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #2c5aa0 0%, #1e3f73 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 1.2rem;
        }

        .reviewer-details h4 {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .review-date {
            font-size: 0.9rem;
            color: #666;
        }

        .review-rating {
            display: flex;
            gap: 2px;
        }

        .review-text {
            margin-bottom: 20px;
            line-height: 1.6;
            color: #555;
        }

        .review-actions {
            display: flex;
            gap: 15px;
        }

        .review-action-btn {
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 5px 10px;
            border-radius: 15px;
            transition: all 0.3s ease;
        }

        .review-action-btn:hover {
            background: #e9ecef;
            color: #333;
        }

        .review-action-btn.active {
            color: #2c5aa0;
            background: rgba(44, 90, 160, 0.1);
        }

        /* Success Message */
        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
            z-index: 2000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .success-message.show {
            transform: translateX(0);
        }

        /* No Reviews */
        .no-reviews {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-menu {
                position: fixed;
                top: 70px;
                left: -100%;
                width: 100%;
                height: calc(100vh - 70px);
                background: white;
                flex-direction: column;
                justify-content: flex-start;
                align-items: center;
                gap: 20px;
                padding-top: 50px;
                transition: left 0.3s ease;
                box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            }

            .nav-menu.active {
                left: 0;
            }

            .hamburger {
                display: flex;
            }

            .course-header {
                grid-template-columns: 1fr;
                gap: 30px;
                padding: 25px;
            }

            .course-main-info h1 {
                font-size: 2rem;
            }

            .course-stats {
                justify-content: space-around;
            }

            .reviews-section,
            .review-form {
                padding: 25px;
            }

            main {
                padding: 20px 15px;
            }

            .success-message {
                right: 10px;
                left: 10px;
                transform: translateY(-100px);
            }

            .success-message.show {
                transform: translateY(0);
            }
        }

        @media (max-width: 480px) {
            .course-meta {
                flex-direction: column;
                gap: 10px;
            }

            .course-stats {
                flex-direction: column;
                gap: 20px;
            }

            .review-header {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .star-rating {
                justify-content: center;
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation: none !important;
                transition: none !important;
            }
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus styles */
        .enroll-btn:focus,
        .watch-btn:focus,
        .submit-review-btn:focus,
        .review-action-btn:focus,
        .star:focus {
            outline: 2px solid #2c5aa0;
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="logo">EduChain</a>
            
            <ul class="nav-menu" id="navMenu">
                <li><a href="home-learner.html" class="nav-link">Home</a></li>
                <li><a href="course-browser.html" class="nav-link">Courses</a></li>
                <li><a href="#" class="nav-link">Search NFT</a></li>
                <li><a href="#" class="nav-link">Profile</a></li>
                <li><a href="login.html" class="nav-link logout-btn">Logout</a></li>
            </ul>

            <button class="hamburger" id="hamburger" aria-label="Toggle navigation menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        <!-- Course Header -->
        <section class="course-header">
            <div class="course-main-info">
                <h1 id="courseTitle">Complete Web Development Bootcamp</h1>
                <div class="course-meta">
                    <span>👨‍🏫 <span id="courseInstructor">Dr. Sarah Johnson</span></span>
                    <span>📚 <span id="courseCategory">Web Development</span></span>
                    <span>⭐ <span id="courseRating">4.8</span> (<span id="reviewCount">1,247</span> reviews)</span>
                </div>
                <p class="course-description" id="courseDescription">
                    Master HTML, CSS, JavaScript, React, Node.js and build amazing web applications from scratch. 
                    This comprehensive bootcamp covers everything you need to become a professional web developer. 
                    Perfect for beginners with no coding experience, this course will take you from zero to hero in web development.
                </p>
                <div class="course-stats">
                    <div class="stat-item">
                        <span class="stat-value" id="enrolledCount">1,247</span>
                        <span class="stat-label">Students Enrolled</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="courseDuration">40h</span>
                        <span class="stat-label">Course Duration</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="courseLevel">Beginner</span>
                        <span class="stat-label">Difficulty Level</span>
                    </div>
                </div>
            </div>
            
            <div class="course-sidebar">
                <div class="course-thumbnail" id="courseThumbnail">💻</div>
                <div class="course-price" id="coursePrice">$99.99</div>
                <button class="enroll-btn" id="enrollBtn">Enroll Now</button>
                <a href="course-watching.html" class="watch-btn" id="watchBtn" style="display: none;">Watch Course</a>
            </div>
        </section>

        <!-- Reviews Section -->
        <section class="reviews-section">
            <h2 class="section-title">Student Reviews</h2>
            
            <!-- Review Form -->
            <div class="review-form" id="reviewForm">
                <h3 style="margin-bottom: 20px; color: #1e3f73;">Leave a Review</h3>
                <form id="submitReviewForm">
                    <div class="form-group">
                        <label>Rating</label>
                        <div class="star-rating" id="starRating">
                            <span class="star" data-rating="1" tabindex="0" role="button" aria-label="1 star">⭐</span>
                            <span class="star" data-rating="2" tabindex="0" role="button" aria-label="2 stars">⭐</span>
                            <span class="star" data-rating="3" tabindex="0" role="button" aria-label="3 stars">⭐</span>
                            <span class="star" data-rating="4" tabindex="0" role="button" aria-label="4 stars">⭐</span>
                            <span class="star" data-rating="5" tabindex="0" role="button" aria-label="5 stars">⭐</span>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="reviewText">Your Review</label>
                        <textarea 
                            id="reviewText" 
                            placeholder="Share your experience with this course..."
                            required
                            aria-describedby="reviewHelp"
                        ></textarea>
                        <div id="reviewHelp" class="sr-only">Describe your experience with this course to help other students</div>
                    </div>
                    <button type="submit" class="submit-review-btn">Submit Review</button>
                </form>
            </div>

            <!-- Reviews List -->
            <div class="reviews-list" id="reviewsList">
                <!-- Reviews will be dynamically inserted here -->
            </div>

            <div class="no-reviews" id="noReviews" style="display: none;">
                <h3>No reviews yet</h3>
                <p>Be the first to leave a review for this course!</p>
            </div>
        </section>
    </main>

    <!-- Success Message -->
    <div class="success-message" id="successMessage" role="alert" aria-live="polite">
        Success! 🎉
    </div>

    <script>
        // Course Information System
        class CourseInfoManager {
            constructor() {
                this.courseId = this.getCourseIdFromUrl() || 1; // Default to course 1
                this.course = null;
                this.reviews = this.loadReviews();
                this.enrolledCourses = this.loadEnrolledCourses();
                this.userRating = 0;
                this.userReviewActions = this.loadUserReviewActions();
                this.init();
            }

            init() {
                this.loadCourse();
                this.bindEvents();
                this.renderCourse();
                this.renderReviews();
            }

            getCourseIdFromUrl() {
                const urlParams = new URLSearchParams(window.location.search);
                return parseInt(urlParams.get('id'));
            }

            loadCourse() {
                const courses = this.loadAllCourses();
                this.course = courses.find(c => c.id === this.courseId);
                
                if (!this.course) {
                    // Default course if not found
                    this.course = {
                        id: 1,
                        title: 'Complete Web Development Bootcamp',
                        description: 'Master HTML, CSS, JavaScript, React, Node.js and build amazing web applications from scratch. This comprehensive bootcamp covers everything you need to become a professional web developer. Perfect for beginners with no coding experience, this course will take you from zero to hero in web development.',
                        category: 'Web Development',
                        instructor: 'Dr. Sarah Johnson',
                        price: 99.99,
                        thumbnail: '💻',
                        enrolled: 1247,
                        rating: 4.8,
                        duration: '40h',
                        level: 'Beginner'
                    };
                }
            }

            bindEvents() {
                // Mobile menu toggle
                const hamburger = document.getElementById('hamburger');
                const navMenu = document.getElementById('navMenu');

                hamburger.addEventListener('click', () => {
                    hamburger.classList.toggle('active');
                    navMenu.classList.toggle('active');
                });

                // Close mobile menu when clicking on a link
                document.querySelectorAll('.nav-link').forEach(link => {
                    link.addEventListener('click', () => {
                        hamburger.classList.remove('active');
                        navMenu.classList.remove('active');
                    });
                });

                // Close mobile menu when clicking outside
                document.addEventListener('click', (e) => {
                    if (!hamburger.contains(e.target) && !navMenu.contains(e.target)) {
                        hamburger.classList.remove('active');
                        navMenu.classList.remove('active');
                    }
                });

                // Enroll button
                document.getElementById('enrollBtn').addEventListener('click', () => {
                    this.enrollInCourse();
                });

                // Star rating
                document.querySelectorAll('.star').forEach(star => {
                    star.addEventListener('click', (e) => {
                        this.userRating = parseInt(e.target.dataset.rating);
                        this.updateStarDisplay();
                    });

                    star.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter' || e.key === ' ') {
                            e.preventDefault();
                            this.userRating = parseInt(e.target.dataset.rating);
                            this.updateStarDisplay();
                        }
                    });

                    star.addEventListener('mouseenter', (e) => {
                        this.highlightStars(parseInt(e.target.dataset.rating));
                    });
                });

                document.getElementById('starRating').addEventListener('mouseleave', () => {
                    this.updateStarDisplay();
                });

                // Review form submission
                document.getElementById('submitReviewForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.submitReview();
                });
            }

            renderCourse() {
                if (!this.course) return;

                document.getElementById('courseTitle').textContent = this.course.title;
                document.getElementById('courseInstructor').textContent = this.course.instructor;
                document.getElementById('courseCategory').textContent = this.course.category;
                document.getElementById('courseDescription').textContent = this.course.description;
                document.getElementById('courseThumbnail').textContent = this.course.thumbnail;
                document.getElementById('enrolledCount').textContent = this.course.enrolled.toLocaleString();
                document.getElementById('courseDuration').textContent = this.course.duration || '20h';
                document.getElementById('courseLevel').textContent = this.course.level || 'Beginner';
                
                // Price
                const priceElement = document.getElementById('coursePrice');
                priceElement.textContent = this.course.price === 0 ? 'Free' : `$${this.course.price}`;

                // Rating
                this.updateCourseRating();

                // Enrollment status
                this.updateEnrollmentStatus();

                // Watch button
                document.getElementById('watchBtn').href = `course-watching.html`;
            }

            updateCourseRating() {
                const courseReviews = this.reviews.filter(r => r.courseId === this.courseId);
                const avgRating = courseReviews.length > 0 
                    ? (courseReviews.reduce((sum, r) => sum + r.rating, 0) / courseReviews.length).toFixed(1)
                    : this.course.rating.toFixed(1);
                
                document.getElementById('courseRating').textContent = avgRating;
                document.getElementById('reviewCount').textContent = courseReviews.length || '1,247';
            }

            updateEnrollmentStatus() {
                const isEnrolled = this.enrolledCourses.includes(this.courseId);
                const enrollBtn = document.getElementById('enrollBtn');
                const watchBtn = document.getElementById('watchBtn');

                if (isEnrolled) {
                    enrollBtn.textContent = '✓ Enrolled';
                    enrollBtn.disabled = true;
                    enrollBtn.style.background = '#28a745';
                    watchBtn.style.display = 'block';
                    enrollBtn.setAttribute('aria-label', 'Already enrolled in this course');
                } else {
                    enrollBtn.textContent = 'Enroll Now';
                    enrollBtn.disabled = false;
                    watchBtn.style.display = 'none';
                    enrollBtn.setAttribute('aria-label', 'Enroll in this course');
                }
            }

            enrollInCourse() {
                if (this.enrolledCourses.includes(this.courseId)) {
                    return; // Already enrolled
                }

                // Add to enrolled courses
                this.enrolledCourses.push(this.courseId);
                this.saveEnrolledCourses();

                // Update course enrollment count
                this.course.enrolled += 1;
                this.updateAllCourses();

                // Update UI
                this.updateEnrollmentStatus();
                document.getElementById('enrolledCount').textContent = this.course.enrolled.toLocaleString();

                this.showSuccessMessage('Successfully enrolled in course! 🎉');
            }

            highlightStars(rating) {
                document.querySelectorAll('.star').forEach((star, index) => {
                    if (index < rating) {
                        star.classList.add('active');
                    } else {
                        star.classList.remove('active');
                    }
                });
            }

            updateStarDisplay() {
                this.highlightStars(this.userRating);
            }

            submitReview() {
                if (this.userRating === 0) {
                    alert('Please select a rating');
                    return;
                }

                const reviewText = document.getElementById('reviewText').value.trim();
                if (!reviewText) {
                    alert('Please write a review');
                    return;
                }

                const review = {
                    id: Date.now(),
                    courseId: this.courseId,
                    userName: 'Current User', // In a real app, this would come from user session
                    rating: this.userRating,
                    text: reviewText,
                    date: new Date().toISOString(),
                    likes: 0,
                    dislikes: 0
                };

                this.reviews.push(review);
                this.saveReviews();

                // Reset form
                this.userRating = 0;
                document.getElementById('reviewText').value = '';
                this.updateStarDisplay();

                // Update display
                this.renderReviews();
                this.updateCourseRating();

                this.showSuccessMessage('Review submitted successfully! 👍');
            }

            renderReviews() {
                const courseReviews = this.reviews.filter(r => r.courseId === this.courseId);
                const container = document.getElementById('reviewsList');
                const noReviews = document.getElementById('noReviews');

                if (courseReviews.length === 0) {
                    container.style.display = 'none';
                    noReviews.style.display = 'block';
                    return;
                }

                container.style.display = 'flex';
                noReviews.style.display = 'none';

                container.innerHTML = courseReviews.map(review => this.createReviewHTML(review)).join('');
                this.bindReviewActions();
            }

            createReviewHTML(review) {
                const reviewDate = new Date(review.date).toLocaleDateString();
                const userActions = this.userReviewActions[review.id] || {};
                
                return `
                    <article class="review-item" data-review-id="${review.id}">
                        <div class="review-header">
                            <div class="reviewer-info">
                                <div class="reviewer-avatar" aria-hidden="true">${review.userName.charAt(0).toUpperCase()}</div>
                                <div class="reviewer-details">
                                    <h4>${this.escapeHtml(review.userName)}</h4>
                                    <div class="review-date">${reviewDate}</div>
                                </div>
                            </div>
                            <div class="review-rating" aria-label="${review.rating} out of 5 stars">
                                ${this.createStarDisplay(review.rating)}
                            </div>
                        </div>
                        <p class="review-text">${this.escapeHtml(review.text)}</p>
                        <div class="review-actions" role="group" aria-label="Review actions">
                            <button class="review-action-btn ${userActions.liked ? 'active' : ''}" 
                                    data-action="like" 
                                    data-review-id="${review.id}"
                                    aria-label="Like this review (${review.likes} likes)">
                                👍 <span>${review.likes}</span>
                            </button>
                            <button class="review-action-btn ${userActions.disliked ? 'active' : ''}" 
                                    data-action="dislike" 
                                    data-review-id="${review.id}"
                                    aria-label="Dislike this review (${review.dislikes} dislikes)">
                                👎 <span>${review.dislikes}</span>
                            </button>
                        </div>
                    </article>
                `;
            }

            createStarDisplay(rating) {
                return Array(5).fill(0).map((_, i) => 
                    `<span style="color: ${i < rating ? '#ffc107' : '#ddd'};" aria-hidden="true">⭐</span>`
                ).join('');
            }

            bindReviewActions() {
                document.querySelectorAll('.review-action-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        this.handleReviewAction(e);
                    });
                });
            }

            handleReviewAction(e) {
                const button = e.currentTarget;
                const action = button.dataset.action;
                const reviewId = parseInt(button.dataset.reviewId);
                const review = this.reviews.find(r => r.id === reviewId);
                
                if (!review) return;

                // Get current user actions for this review
                let userActions = this.userReviewActions[reviewId] || {};

                // Toggle the action
                if (action === 'like') {
                    if (userActions.liked) {
                        // Remove like
                        review.likes = Math.max(0, review.likes - 1);
                        userActions.liked = false;
                    } else {
                        // Add like
                        review.likes += 1;
                        userActions.liked = true;
                        
                        // Remove dislike if it exists
                        if (userActions.disliked) {
                            review.dislikes = Math.max(0, review.dislikes - 1);
                            userActions.disliked = false;
                        }
                    }
                } else if (action === 'dislike') {
                    if (userActions.disliked) {
                        // Remove dislike
                        review.dislikes = Math.max(0, review.dislikes - 1);
                        userActions.disliked = false;
                    } else {
                        // Add dislike
                        review.dislikes += 1;
                        userActions.disliked = true;
                        
                        // Remove like if it exists
                        if (userActions.liked) {
                            review.likes = Math.max(0, review.likes - 1);
                            userActions.liked = false;
                        }
                    }
                }

                // Save user actions
                this.userReviewActions[reviewId] = userActions;
                this.saveUserReviewActions();

                // Save reviews
                this.saveReviews();

                // Re-render reviews
                this.renderReviews();
            }

            showSuccessMessage(message) {
                const successElement = document.getElementById('successMessage');
                successElement.textContent = message;
                successElement.classList.add('show');
                
                setTimeout(() => {
                    successElement.classList.remove('show');
                }, 3000);
            }

            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }

            // Data persistence methods
            loadAllCourses() {
                const saved = localStorage.getItem('educhain_all_courses');
                return saved ? JSON.parse(saved) : this.getDefaultCourses();
            }

            updateAllCourses() {
                let courses = this.loadAllCourses();
                const courseIndex = courses.findIndex(c => c.id === this.courseId);
                if (courseIndex !== -1) {
                    courses[courseIndex] = this.course;
                    localStorage.setItem('educhain_all_courses', JSON.stringify(courses));
                }
            }

            loadEnrolledCourses() {
                const saved = localStorage.getItem('educhain_enrolled_courses');
                return saved ? JSON.parse(saved) : [];
            }

            saveEnrolledCourses() {
                localStorage.setItem('educhain_enrolled_courses', JSON.stringify(this.enrolledCourses));
            }

            loadReviews() {
                const saved = localStorage.getItem('educhain_reviews');
                return saved ? JSON.parse(saved) : this.getDefaultReviews();
            }

            saveReviews() {
                localStorage.setItem('educhain_reviews', JSON.stringify(this.reviews));
            }

            loadUserReviewActions() {
                const saved = localStorage.getItem('educhain_user_review_actions');
                return saved ? JSON.parse(saved) : {};
            }

            saveUserReviewActions() {
                localStorage.setItem('educhain_user_review_actions', JSON.stringify(this.userReviewActions));
            }

            getDefaultCourses() {
                return [
                    {
                        id: 1,
                        title: 'Complete Web Development Bootcamp',
                        description: 'Master HTML, CSS, JavaScript, React, Node.js and build amazing web applications from scratch. This comprehensive bootcamp covers everything you need to become a professional web developer. Perfect for beginners with no coding experience, this course will take you from zero to hero in web development.',
                        category: 'Web Development',
                        instructor: 'Dr. Sarah Johnson',
                        price: 99.99,
                        thumbnail: '💻',
                        enrolled: 1247,
                        rating: 4.8,
                        duration: '40h',
                        level: 'Beginner'
                    }
                ];
            }

            getDefaultReviews() {
                return [
                    {
                        id: 1,
                        courseId: 1,
                        userName: 'John Smith',
                        rating: 5,
                        text: 'Excellent course! The instructor explains everything clearly and the projects are very practical. I went from knowing nothing about web development to building my own websites.',
                        date: new Date(Date.now() - 86400000 * 7).toISOString(), // 7 days ago
                        likes: 15,
                        dislikes: 1
                    },
                    {
                        id: 2,
                        courseId: 1,
                        userName: 'Maria Garcia',
                        rating: 4,
                        text: 'Great content and well-structured lessons. The pace is perfect for beginners. The only minor issue is that some of the examples could be updated to use more modern practices.',
                        date: new Date(Date.now() - 86400000 * 3).toISOString(), // 3 days ago
                        likes: 8,
                        dislikes: 0
                    },
                    {
                        id: 3,
                        courseId: 1,
                        userName: 'Alex Chen',
                        rating: 5,
                        text: 'This course changed my career! I was able to land a junior developer position just 3 months after completing it. The hands-on projects really helped build my portfolio.',
                        date: new Date(Date.now() - 86400000 * 1).toISOString(), // 1 day ago
                        likes: 23,
                        dislikes: 0
                    }
                ];
            }
        }

        // Initialize course info manager when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            new CourseInfoManager();
        });

        // Keyboard accessibility
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                const hamburger = document.getElementById('hamburger');
                const navMenu = document.getElementById('navMenu');
                hamburger.classList.remove('active');
                navMenu.classList.remove('active');
            }
        });
    </script>
</body>
</html>
